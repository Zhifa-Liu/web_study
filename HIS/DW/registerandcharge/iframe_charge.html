<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>HIS-Reg-2</title>
<link href="../css/common.css" rel="stylesheet" type="text/css">
<script>var __adobewebfontsappname__="dreamweaver"</script>
<script src="http://use.edgefonts.net/source-sans-pro:n2:default.js" type="text/javascript"></script>
<script src="../js/jquery-3.3.1.min.js"></script>
<script src="../js/layer/layer.js"></script>
<script>
    function selectAll(state){
        var cb = document.getElementsByTagName("input");
        for(let i=0; i< cb.length; i++){
            if(cb[i].type==="checkbox")
                cb[i].checked = state;
        }
    }
    function computeAll(){
        var table = document.getElementById("consumption");
        var rows = table.rows;
        var total_price = 0;
        for(var i=1; i<rows.length; i++){
            var price = Number(rows[i].cells[3].innerText);
            var count = Number(rows[i].cells[5].innerText);
            total_price = price*count;
        }
        return total_price;
    }
	function popup(title,url){
       	layer.open({
            type: 2,
            title: title,
            area: ['40%', '240px'],
            content: [url, 'no'],
            success: function(layero,index){
                var total = computeAll();
				var body = layer.getChildFrame('body',index);
                console.log(total);
                console.log(body);
				body.find("#all").val(total);
            }
        });
	}
</script>
<style>
	.label_1{
		margin-left: 30%;
	}
	.label_2{
		font-size: 15px;
	}
	#consumption{
		width: 80%;
		margin-left: 4%;
		margin-top: 20px;
		font-size: 15px;
		border: 1px;
		border-collapse: collapse;
	}
	#consumption th{
		text-align: left;
		font-weight: 500;
		background-color: #D0E7E8;
	}
	#consumption td,#consumption th{
		border: 1px solid white;
	}
</style>
</head>
	
<body>

<div style="width:100%; height: 600px; background: #D0E7E8;">
    <table width="750" height="150" border="0" style="margin-left: 2%;">
        <tbody>
            <tr>
                <td><div style="margin-top: 12px;"><label class="label">患者信息查询</label></div></td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td><label class="label label_1 label_2">病历号:</label></td>
                <td><input type="text" name="mrn" class="input" placeholder="输入病历号"></td>
                <td>&nbsp;</td>
                <td><input type="button" class="button" value="查询"></td>
            </tr>
            <tr>
                <td><label class="label">患者信息确认</label></td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td><label class="label label_1 label_2">姓名:</label></td>
                <td><input type="text" name="textfield" class="input" readonly></td>
                <td><label class="label label_2">身份证号:</label></td>
                <td><input type="text" name="textfield" class="input" readonly></td>
            </tr>
        </tbody>
    </table>
    <hr width="95%">
    <div style="margin-left: 2.4%;margin-top: 30px;margin-bottom: 30px;height: 360px;">
        <label style="margin-right: 64px;">患者消费</label>
        <input type="button" class="button" value="收费" onClick="popup('收费详情','charge_popup.html')">
        <input id="t_price" type="text" style="visibility: hidden;">
        <table id="consumption">
            <tbody>
                <tr>
                    <th><input type="checkbox" onClick="computeAll(); if(this.checked===checked){selectAll(checked);}else{selectAll(false)}"></th>
                    <th><label class="label">药品编码</label></th>
                    <th><label class="label">药品名称</label></th>
                    <th><label class="label">单价</label></th>
                    <th><label class="label">规格</label></th>
                    <th><label class="label">数量</label></th>
                </tr>
                <tr>
                <td class="td_cb"><input type="checkbox"></td>
                    <td>暂无</td>
                    <td>暂无</td>
                    <td>2</td>
                    <td>暂无</td>
                    <td>4</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

</body>
</html>

